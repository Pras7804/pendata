
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Naive Bayes &#8212; Penambangan Data</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Naive_Bayes';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tipe Data" href="tipe_data.html" />
    <link rel="prev" title="Deteksi Outlier" href="Deteksi_Outlier.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/1.jpeg" class="logo__image only-light" alt="Penambangan Data - Home"/>
    <script>document.write(`<img src="_static/1.jpeg" class="logo__image only-dark" alt="Penambangan Data - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Penambangan Data
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="data_understanding.html"><strong>Memahami Data</strong></a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Deteksi_Outlier.html"><strong>Deteksi Outlier</strong></a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#"><strong>Naive Bayes</strong></a></li>
<li class="toctree-l2"><a class="reference internal" href="tipe_data.html"><strong>Tipe Data</strong></a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FNaive_Bayes.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Naive_Bayes.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Naive Bayes</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#apa-itu-naive-bayes"><strong>Apa itu Naive Bayes?</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#contoh-contoh-algoritme-naive-bayes"><strong>Contoh-Contoh algoritme Naive Bayes</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jenis-jenis-naive-bayes"><strong>Jenis-Jenis Naive Bayes</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prinsip-teorema-bayes"><strong>Prinsip Teorema Bayes</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#langkah-langkah-klasifikasi"><strong>Langkah-Langkah Klasifikasi</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#contoh-kasus-dalam-data-numerik"><strong>Contoh Kasus dalam Data Numerik</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#langkah-langkah"><strong>Langkah-Langkah</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hitung-probabilitas-awal-p-y"><strong>1. Hitung Probabilitas Awal <span class="math notranslate nohighlight">\((P(Y))\)</span></strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hitung-likelihood-p-x-y"><strong>2. Hitung Likelihood <span class="math notranslate nohighlight">\(P(X|Y)\)</span></strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gabungkan-dengan-teorema-bayes"><strong>3. Gabungkan dengan Teorema Bayes</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prediksi-kelas"><strong>4. Prediksi Kelas</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementasi-pada-data-iris"><strong>Implementasi pada Data Iris</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#memisahkan-outlier-dari-data"><strong>Memisahkan Outlier dari Data</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#menghitung-akurasi-dari-data"><strong>Menghitung Akurasi dari Data</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementasi-naive-bayes"><strong>Implementasi Naive Bayes</strong></a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="naive-bayes">
<h1><strong>Naive Bayes</strong><a class="headerlink" href="#naive-bayes" title="Link to this heading">#</a></h1>
<section id="apa-itu-naive-bayes">
<h2><strong>Apa itu Naive Bayes?</strong><a class="headerlink" href="#apa-itu-naive-bayes" title="Link to this heading">#</a></h2>
<p>Naïve Bayes adalah sebuah algoritma klasifikasi berbasis probabilitas yang didasarkan pada Teorema Bayes dengan asumsi bahwa setiap fitur dalam data bersifat independen (naïve = “naif” atau sederhana). Meskipun asumsi ini jarang sepenuhnya benar dalam dunia nyata, Naïve Bayes tetap bekerja dengan baik dalam banyak kasus, terutama untuk klasifikasi teks seperti filtering spam, analisis sentimen, dan pengenalan dokumen.</p>
</section>
<section id="contoh-contoh-algoritme-naive-bayes">
<h2><strong>Contoh-Contoh algoritme Naive Bayes</strong><a class="headerlink" href="#contoh-contoh-algoritme-naive-bayes" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Filtering Spam</p></li>
<li><p>Analisis Sentimen</p></li>
<li><p>klasifikasi Dokumen</p></li>
<li><p>System Rekomendasi</p></li>
<li><p>Perkiraan Cuaca</p></li>
</ol>
</section>
<section id="jenis-jenis-naive-bayes">
<h2><strong>Jenis-Jenis Naive Bayes</strong><a class="headerlink" href="#jenis-jenis-naive-bayes" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>Gaussian Naive Bayes</strong>
*   Digunakan jika fitur memiliki distribusi normal (Gaussian).
*   Cocok untuk data numerik</p></li>
<li><p><strong>Multinomial Naive Bayes</strong>
*   Cocok untuk klasifikasi teks seperti <em>spam filtering</em> dan <em>analisis sentimen</em>.
*   Bekerja dengan menghitung frekuensi kata.</p></li>
<li><p><strong>Bernoulli Naive Bayes</strong>
*   Mirip dengan multinomial, tetapi bekerja dengan fitur biner (0 atau 1).
*   Sering digunakan untuk klasifikasi teks dengan fitur “ada/tidaknya kata tertentu”.</p></li>
</ol>
</section>
<section id="prinsip-teorema-bayes">
<h2><strong>Prinsip Teorema Bayes</strong><a class="headerlink" href="#prinsip-teorema-bayes" title="Link to this heading">#</a></h2>
<p>Dasar Teorema Bayes:</p>
<div class="math notranslate nohighlight">
\[ P(Y|X) = \frac{P(X|Y) \cdot P(Y)}{P(X)} \]</div>
<p>Penjelasan:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( P(Y|X) \)</span>: Probabilitas posterior (kelas <span class="math notranslate nohighlight">\( Y \)</span> diberikan fitur <span class="math notranslate nohighlight">\( X \)</span>).</p></li>
<li><p><span class="math notranslate nohighlight">\( P(X|Y) \)</span>: Likelihood (probabilitas fitur <span class="math notranslate nohighlight">\( X \)</span> diberikan kelas <span class="math notranslate nohighlight">\( Y \)</span>).</p></li>
<li><p><span class="math notranslate nohighlight">\( P(Y) \)</span>: Prior probability (probabilitas awal kelas <span class="math notranslate nohighlight">\( Y \)</span>).</p></li>
<li><p><span class="math notranslate nohighlight">\( P(X) \)</span>: Evidence (probabilitas fitur <span class="math notranslate nohighlight">\( X \)</span> secara keseluruhan).</p></li>
</ul>
<p>Tujuan:</p>
<p>Mencari kelas <span class="math notranslate nohighlight">\( Y \)</span> dengan nilai <span class="math notranslate nohighlight">\( P(Y|X) \)</span> tertinggi.</p>
</section>
<section id="langkah-langkah-klasifikasi">
<h2><strong>Langkah-Langkah Klasifikasi</strong><a class="headerlink" href="#langkah-langkah-klasifikasi" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Persiapan Data:</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Pisahkan data menjadi fitur $(X)$ dan label $(Y)$.
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p>Hitung Probabilitas Awal <span class="math notranslate nohighlight">\((P(Y))\)</span>:</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Hitung frekuensi setiap kelas dalam dataset
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Hitung Likelihood <span class="math notranslate nohighlight">\((P(X|Y))\)</span>:</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Untuk setiap fitur, hitung probabilitas kemunculannya dalam setiap kelas.
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li><p>Gabungkan dengan Teorema Bayes:</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Menggunakan rumus
</pre></div>
</div>
<div class="math notranslate nohighlight">
\[
  P(Y|X) = \frac{P(X|Y) \cdot P(Y)}{P(X)}
  \]</div>
<ol class="arabic simple" start="5">
<li><p>Prediksi Kelas:</p></li>
</ol>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Pilih kelas dengan nilai $P(X|Y)$ Tertinggi.
</pre></div>
</div>
</section>
<section id="contoh-kasus-dalam-data-numerik">
<h2><strong>Contoh Kasus dalam Data Numerik</strong><a class="headerlink" href="#contoh-kasus-dalam-data-numerik" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>X1(TInggi)</p></th>
<th class="head"><p>X2(Berat)</p></th>
<th class="head"><p>Y(Olahraga)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>160</p></td>
<td><p>55</p></td>
<td><p>Tidak</p></td>
</tr>
<tr class="row-odd"><td><p>165</p></td>
<td><p>60</p></td>
<td><p>tidak</p></td>
</tr>
<tr class="row-even"><td><p>170</p></td>
<td><p>65</p></td>
<td><p>Ya</p></td>
</tr>
<tr class="row-odd"><td><p>175</p></td>
<td><p>70</p></td>
<td><p>Ya</p></td>
</tr>
<tr class="row-even"><td><p>180</p></td>
<td><p>80</p></td>
<td><p>Ya</p></td>
</tr>
</tbody>
</table>
</div>
<p>Kita ingin memprediksi kelas untuk <strong>Data Baru:</strong> (TInggi = 168, Berat = 62)</p>
</section>
<section id="langkah-langkah">
<h2><strong>Langkah-Langkah</strong><a class="headerlink" href="#langkah-langkah" title="Link to this heading">#</a></h2>
<section id="hitung-probabilitas-awal-p-y">
<h3><strong>1. Hitung Probabilitas Awal <span class="math notranslate nohighlight">\((P(Y))\)</span></strong><a class="headerlink" href="#hitung-probabilitas-awal-p-y" title="Link to this heading">#</a></h3>
<p><span class="math notranslate nohighlight">\(
P(Y = Tidak) = \frac{2}{5} = 0.4
\)</span></p>
<p><span class="math notranslate nohighlight">\(
P(Y = Ya) = \frac {3}{5} = 0.6
\)</span></p>
</section>
<section id="hitung-likelihood-p-x-y">
<h3><strong>2. Hitung Likelihood <span class="math notranslate nohighlight">\(P(X|Y)\)</span></strong><a class="headerlink" href="#hitung-likelihood-p-x-y" title="Link to this heading">#</a></h3>
<p>a. Rata-rata (<span class="math notranslate nohighlight">\(\mu\)</span>) dan (<span class="math notranslate nohighlight">\(\sigma^2\)</span>) untuk masing-masing kelas</p>
<ul class="simple">
<li><p><strong>Kelas Tidak</strong></p>
<ul>
<li><p><span class="math notranslate nohighlight">\(\mu_{X_1} = \frac{160 + 165}{2} = 162.\)</span><br />
$\sigma_{X_1}^2 \approx 6.25$</p></li>
<li><p><span class="math notranslate nohighlight">\(\mu_{X_2} = \frac{55 + 60}{2} = 57.5\)</span>
$\sigma_{X_2}^2 \approx 6.25$</p></li>
</ul>
</li>
<li><p><strong>Kelas Ya</strong></p>
<ul>
<li><p><span class="math notranslate nohighlight">\(\mu_{X_1} = \frac{170 + 175 + 180}{3} = 175\)</span><br />
<span class="math notranslate nohighlight">\(\sigma_{X_1}^2 \approx 16.67\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\mu_{X_2} = \frac{65 + 70 + 80}{3} \approx 71.67\)</span><br />
<span class="math notranslate nohighlight">\(\sigma_{X_2}^2 \approx 38.89\)</span></p></li>
</ul>
</li>
</ul>
<p>b. Hitung <span class="math notranslate nohighlight">\(P(X_1 = 168 | Y)\)</span> dan <span class="math notranslate nohighlight">\(P(S_2 = 62 | Y)\)</span></p>
<p>Menggunakan rumus Gaussian (normal):</p>
<p><span class="math notranslate nohighlight">\(
P(x \mid \mu, \sigma^2) = \frac{1}{\sqrt{2\pi\sigma^2}}
\exp\Bigl(-\frac{(x - \mu)^2}{2\sigma^2}\Bigr)
\)</span></p>
<p><strong>Contoh perhitungan ringkas</strong> (tidak semua detail angka ditunjukkan):</p>
<ul class="simple">
<li><p><strong>Untuk Kelas Tidak</strong>:
<span class="math notranslate nohighlight">\(
  P(X_1 = 168 \mid \text{Tidak}) \times P(X_2 = 62 \mid \text{Tidak})
  \approx 0.014 \times 0.031 = 0.000434
\)</span></p></li>
<li><p><strong>Untuk Kelas Ya</strong>:
<span class="math notranslate nohighlight">\(
  P(X_1 = 168 \mid \text{Ya}) \times P(X_2 = 62 \mid \text{Ya})
  \approx 0.0225 \times 0.0193 = 0.000434 \quad (\text{misal})
\)</span></p></li>
</ul>
</section>
<section id="gabungkan-dengan-teorema-bayes">
<h3><strong>3. Gabungkan dengan Teorema Bayes</strong><a class="headerlink" href="#gabungkan-dengan-teorema-bayes" title="Link to this heading">#</a></h3>
<p><span class="math notranslate nohighlight">\(
P(Y \mid X) = \frac{P(X \mid Y)\, P(Y)}{P(X)}
\)</span></p>
<p>Karena (P(X)) adalah konstanta pembagi (sama untuk semua kelas), kita fokus pada <strong>pembilang</strong> saja:</p>
<ul class="simple">
<li><p><strong>Skor untuk Kelas Tidak</strong>:</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(
P(X_1 = 168, X_2 = 62 \mid \text{Tidak}) \times P(\text{Tidak})
\quad \underbrace{\text{(likelihood)}}_{\quad} \times \underbrace{\text{(prior)}}_{\quad}
\)</span></p>
<ul class="simple">
<li><p><strong>Skor untuk Kelas Ya</strong>:</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(
P(X_1 = 168, X_2 = 62 \mid \text{Ya}) \times P(\text{Ya})
\quad \underbrace{\text{(likelihood)}}_{\quad} \times \underbrace{\text{(prior)}}_{\quad}
\)</span></p>
<p>Bandingkan kedua skor tersebut</p>
</section>
<section id="prediksi-kelas">
<h3><strong>4. Prediksi Kelas</strong><a class="headerlink" href="#prediksi-kelas" title="Link to this heading">#</a></h3>
<p>Pilih kelas dengan nilai <span class="math notranslate nohighlight">\(P(Y|X)\)</span> (atau skor) terbesar.
Misalnya hasil akhirnya lebih besar untuk <strong>kelas Ya</strong>, MAka prediksi untuk (168, 62) adalah <strong>“Ya”</strong>.</p>
</section>
</section>
<section id="implementasi-pada-data-iris">
<h2><strong>Implementasi pada Data Iris</strong><a class="headerlink" href="#implementasi-pada-data-iris" title="Link to this heading">#</a></h2>
<p><strong>Upload data iris</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">files</span>

<span class="c1"># Unggah file CSV</span>
<span class="n">uploaded</span> <span class="o">=</span> <span class="n">files</span><span class="o">.</span><span class="n">upload</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">files</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="c1"># Unggah file CSV</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">uploaded</span> <span class="o">=</span> <span class="n">files</span><span class="o">.</span><span class="n">upload</span><span class="p">()</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;google&#39;
</pre></div>
</div>
</div>
</div>
<p><strong>import dan install library yang diperlukan</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">LocalOutlierFactor</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>pymysql
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>pandas
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>psycopg2-binary
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>sqlalchemy
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>python-dotenv
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting pymysql
  Downloading PyMySQL-1.1.1-py3-none-any.whl.metadata (4.4 kB)
Downloading PyMySQL-1.1.1-py3-none-any.whl (44 kB)
?25l   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">0.0/45.0 kB</span> <span class=" -Color -Color-Red">?</span> eta <span class=" -Color -Color-Cyan">-:--:--</span>
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">45.0/45.0 kB</span> <span class=" -Color -Color-Red">1.7 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hInstalling collected packages: pymysql
Successfully installed pymysql-1.1.1
Requirement already satisfied: pandas in /usr/local/lib/python3.11/dist-packages (2.2.2)
Requirement already satisfied: numpy&gt;=1.23.2 in /usr/local/lib/python3.11/dist-packages (from pandas) (2.0.2)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /usr/local/lib/python3.11/dist-packages (from pandas) (2.8.2)
Requirement already satisfied: pytz&gt;=2020.1 in /usr/local/lib/python3.11/dist-packages (from pandas) (2025.1)
Requirement already satisfied: tzdata&gt;=2022.7 in /usr/local/lib/python3.11/dist-packages (from pandas) (2025.1)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.11/dist-packages (from python-dateutil&gt;=2.8.2-&gt;pandas) (1.17.0)
Collecting psycopg2-binary
  Downloading psycopg2_binary-2.9.10-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.9 kB)
Downloading psycopg2_binary-2.9.10-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.0 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">3.0/3.0 MB</span> <span class=" -Color -Color-Red">26.8 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hInstalling collected packages: psycopg2-binary
Successfully installed psycopg2-binary-2.9.10
Requirement already satisfied: sqlalchemy in /usr/local/lib/python3.11/dist-packages (2.0.39)
Requirement already satisfied: greenlet!=0.4.17 in /usr/local/lib/python3.11/dist-packages (from sqlalchemy) (3.1.1)
Requirement already satisfied: typing-extensions&gt;=4.6.0 in /usr/local/lib/python3.11/dist-packages (from sqlalchemy) (4.12.2)
Requirement already satisfied: python-dotenv in /usr/local/lib/python3.11/dist-packages (1.1.0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sqlalchemy</span> <span class="kn">import</span> <span class="n">create_engine</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span>

<span class="n">load_dotenv</span><span class="p">()</span>

<span class="c1"># Ambil variabel koneksi dari lingkungan</span>
<span class="n">MYSQL_HOST</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;MYSQL_HOST&quot;</span><span class="p">)</span>
<span class="n">MYSQL_PORT</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;MYSQL_PORT&quot;</span><span class="p">)</span>
<span class="n">MYSQL_USER</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;MYSQL_USER&quot;</span><span class="p">)</span>
<span class="n">MYSQL_PASSWORD</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;MYSQL_PASSWORD&quot;</span><span class="p">)</span>
<span class="n">MYSQL_DATABASE</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;MYSQL_DATABASE&quot;</span><span class="p">)</span>

<span class="n">PG_HOST</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;PG_HOST&quot;</span><span class="p">)</span>
<span class="n">PG_PORT</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;PG_PORT&quot;</span><span class="p">)</span>
<span class="n">PG_USER</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;PG_USER&quot;</span><span class="p">)</span>
<span class="n">PG_PASSWORD</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;PG_PASSWORD&quot;</span><span class="p">)</span>
<span class="n">PG_DATABASE</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;PG_DATABASE&quot;</span><span class="p">)</span>

<span class="c1"># Gunakan SQLAlchemy untuk koneksi ke MySQL</span>
<span class="n">mysql_engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mysql+pymysql://</span><span class="si">{</span><span class="n">MYSQL_USER</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">MYSQL_PASSWORD</span><span class="si">}</span><span class="s2">@</span><span class="si">{</span><span class="n">MYSQL_HOST</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">MYSQL_PORT</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">MYSQL_DATABASE</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Gunakan SQLAlchemy untuk koneksi ke PostgreSQL</span>
<span class="n">pg_engine</span> <span class="o">=</span> <span class="n">create_engine</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;postgresql+psycopg2://</span><span class="si">{</span><span class="n">PG_USER</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">PG_PASSWORD</span><span class="si">}</span><span class="s2">@</span><span class="si">{</span><span class="n">PG_HOST</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">PG_PORT</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">PG_DATABASE</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Jalankan query</span>
<span class="n">mysql_query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM iris_data;&quot;</span>
<span class="n">df_mysql</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">mysql_query</span><span class="p">,</span> <span class="n">mysql_engine</span><span class="p">)</span>

<span class="n">pg_query</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM iris_data;&quot;</span>
<span class="n">df_postgres</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">pg_query</span><span class="p">,</span> <span class="n">pg_engine</span><span class="p">)</span>

<span class="c1"># Print hasil</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data dari MySQL:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_mysql</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data dari PostgreSQL:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_postgres</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data dari MySQL:
   id        class  petal_length  petal_width
0   1  Iris-setosa           1.4          0.2
1   2  Iris-setosa           1.4          0.2
2   3  Iris-setosa          55.0         45.3
3   4  Iris-setosa           1.5          0.2
4   5  Iris-setosa          30.4         20.0

Data dari PostgreSQL:
   id        class  sepal_length  sepal_width
0   1  Iris-setosa           5.1          3.5
1   4  Iris-setosa           4.6          3.1
2   6  Iris-setosa           5.4          3.9
3   7  Iris-setosa           4.6          3.4
4   8  Iris-setosa           5.0          3.4
</pre></div>
</div>
</div>
</div>
<p><strong>Menggabungkan Data</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Menggabungkan data</span>
<span class="n">df_combined</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_postgres</span><span class="p">,</span> <span class="n">df_mysql</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]),</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Data gabungan:&quot;</span><span class="p">)</span>
<span class="n">df_combined</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Data gabungan:
</pre></div>
</div>
<div class="output text_html">
  <div id="df-ff159858-d22a-4d07-a2f8-6f9f475c9480" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>class</th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Iris-setosa</td>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>Iris-setosa</td>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6</td>
      <td>Iris-setosa</td>
      <td>5.4</td>
      <td>3.9</td>
      <td>1.7</td>
      <td>0.4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7</td>
      <td>Iris-setosa</td>
      <td>4.6</td>
      <td>3.4</td>
      <td>1.4</td>
      <td>0.3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8</td>
      <td>Iris-setosa</td>
      <td>5.0</td>
      <td>3.4</td>
      <td>1.5</td>
      <td>0.2</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-ff159858-d22a-4d07-a2f8-6f9f475c9480')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-ff159858-d22a-4d07-a2f8-6f9f475c9480 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-ff159858-d22a-4d07-a2f8-6f9f475c9480');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-b94c1d2b-7d07-4940-8b1c-2a1cf9a6b596">
  <button class="colab-df-quickchart" onclick="quickchart('df-b94c1d2b-7d07-4940-8b1c-2a1cf9a6b596')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-b94c1d2b-7d07-4940-8b1c-2a1cf9a6b596 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>
</div></div>
</div>
</section>
<section id="memisahkan-outlier-dari-data">
<h2><strong>Memisahkan Outlier dari Data</strong><a class="headerlink" href="#memisahkan-outlier-dari-data" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">LocalOutlierFactor</span>


<span class="c1"># Asumsikan hanya kolom-kolom numerik yang akan dipakai</span>
<span class="c1"># Jika data iris memiliki kolom: sepal_length, sepal_width, petal_length, petal_width, maka:</span>
<span class="n">features_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sepal_length&#39;</span><span class="p">,</span> <span class="s1">&#39;sepal_width&#39;</span><span class="p">,</span> <span class="s1">&#39;petal_length&#39;</span><span class="p">,</span> <span class="s1">&#39;petal_width&#39;</span><span class="p">]</span>
<span class="n">data_values</span> <span class="o">=</span> <span class="n">df_combined</span><span class="p">[</span><span class="n">features_columns</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Inisialisasi model LOF</span>
<span class="c1"># n_neighbors: Jumlah tetangga terdekat untuk perhitungan kepadatan lokal.</span>
<span class="n">lof</span> <span class="o">=</span> <span class="n">LocalOutlierFactor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>

<span class="c1"># Lakukan fitting dan prediksi outlier.</span>
<span class="c1"># fit_predict() akan menghasilkan label: 1 (inlier) dan -1 (outlier).</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">lof</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">df_combined</span><span class="p">[</span><span class="n">features_columns</span><span class="p">])</span>

<span class="c1"># Tambahkan hasil ke dataframe</span>
<span class="n">df_combined</span><span class="p">[</span><span class="s1">&#39;LOF_label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_pred</span>

<span class="c1"># Cetak hasil dengan ID dan class</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_combined</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

<span class="n">num_outliers</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_pred</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Jumlah outlier: </span><span class="si">{</span><span class="n">num_outliers</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">df_filtered</span> <span class="o">=</span> <span class="n">df_combined</span><span class="p">[</span><span class="n">y_pred</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;LOF_label&quot;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="n">outliers</span> <span class="o">=</span> <span class="n">df_combined</span><span class="p">[</span><span class="n">y_pred</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;LOF_label&quot;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data Outlier:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">outliers</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Jumlah data setelah dihapus : &quot;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">df_filtered</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Data tidak outlier :&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_filtered</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          class  sepal_length  sepal_width  petal_length  petal_width  Class  class_num  LOF_label
    Iris-setosa           5.1          3.5           1.4          0.2      0          0          1
    Iris-setosa           4.6          3.1           1.5          0.2      0          0          1
    Iris-setosa           5.4          3.9           1.7          0.4      0          0          1
    Iris-setosa           4.6          3.4           1.4          0.3      0          0          1
    Iris-setosa           5.0          3.4           1.5          0.2      0          0          1
    Iris-setosa           4.4          2.9           1.4          0.2      0          0          1
    Iris-setosa           4.9          3.1           1.5          0.1      0          0          1
    Iris-setosa           5.4          3.7           1.5          0.2      0          0          1
    Iris-setosa           4.8          3.4           1.6          0.2      0          0          1
    Iris-setosa           4.8          3.0           1.4          0.1      0          0          1
    Iris-setosa           4.3          3.0           1.1          0.1      0          0          1
    Iris-setosa           5.8          4.0           1.2          0.2      0          0          1
    Iris-setosa           5.7          4.4           1.5          0.4      0          0          1
    Iris-setosa           5.4          3.9           1.3          0.4      0          0          1
    Iris-setosa           5.1          3.5           1.4          0.3      0          0          1
    Iris-setosa           5.7          3.8           1.7          0.3      0          0          1
    Iris-setosa           5.1          3.8           1.5          0.3      0          0          1
    Iris-setosa           5.4          3.4           1.7          0.2      0          0          1
    Iris-setosa           5.1          3.7           1.5          0.4      0          0          1
    Iris-setosa           4.6          3.6           1.0          0.2      0          0          1
    Iris-setosa           5.1          3.3           1.7          0.5      0          0          1
    Iris-setosa           4.8          3.4           1.9          0.2      0          0          1
    Iris-setosa           5.0          3.0           1.6          0.2      0          0          1
    Iris-setosa           5.0          3.4           1.6          0.4      0          0          1
    Iris-setosa           5.2          3.4           1.4          0.2      0          0          1
    Iris-setosa           4.8          3.1           1.6          0.2      0          0          1
    Iris-setosa           5.4          3.4           1.5          0.4      0          0          1
    Iris-setosa           5.2          4.1           1.5          0.1      0          0          1
    Iris-setosa           5.5          4.2           1.4          0.2      0          0          1
    Iris-setosa           4.9          3.1           1.5          0.1      0          0          1
    Iris-setosa           5.0          3.2           1.2          0.2      0          0          1
    Iris-setosa           5.5          3.5           1.3          0.2      0          0          1
    Iris-setosa           4.9          3.1           1.5          0.1      0          0          1
    Iris-setosa           4.4          3.0           1.3          0.2      0          0          1
    Iris-setosa           5.1          3.4           1.5          0.2      0          0          1
    Iris-setosa           5.0          3.5           1.3          0.3      0          0          1
    Iris-setosa           4.5          2.3           1.3          0.3      0          0          1
    Iris-setosa           4.4          3.2           1.3          0.2      0          0          1
    Iris-setosa           5.0          3.5           1.6          0.6      0          0          1
    Iris-setosa           5.1          3.8           1.9          0.4      0          0          1
    Iris-setosa           4.8          3.0           1.4          0.3      0          0          1
    Iris-setosa           5.1          3.8           1.6          0.2      0          0          1
    Iris-setosa           4.6          3.2           1.4          0.2      0          0          1
    Iris-setosa           5.3          3.7           1.5          0.2      0          0          1
Iris-versicolor           7.0          3.2           4.7          1.4      1          1          1
Iris-versicolor           6.4          3.2           4.5          1.5      1          1          1
Iris-versicolor           6.9          3.1           4.9          1.5      1          1          1
Iris-versicolor           5.5          2.3           4.0          1.3      1          1          1
Iris-versicolor           6.5          2.8           4.6          1.5      1          1          1
Iris-versicolor           5.7          2.8           4.5          1.3      1          1          1
Iris-versicolor           6.3          3.3           4.7          1.6      1          1          1
Iris-versicolor           4.9          2.4           3.3          1.0      1          1          1
Iris-versicolor           5.2          2.7           3.9          1.4      1          1          1
Iris-versicolor           5.0          2.0           3.5          1.0      1          1          1
Iris-versicolor           6.0          2.2           4.0          1.0      1          1          1
Iris-versicolor           6.1          2.9           4.7          1.4      1          1          1
Iris-versicolor           5.6          2.9           3.6          1.3      1          1          1
Iris-versicolor           6.7          3.1           4.4          1.4      1          1          1
Iris-versicolor           5.6          3.0           4.5          1.5      1          1          1
Iris-versicolor           5.8          2.7           4.1          1.0      1          1          1
Iris-versicolor           6.2          2.2           4.5          1.5      1          1          1
Iris-versicolor           5.6          2.5           3.9          1.1      1          1          1
Iris-versicolor           6.1          2.8           4.0          1.3      1          1          1
Iris-versicolor           6.1          2.8           4.7          1.2      1          1          1
Iris-versicolor           6.4          2.9           4.3          1.3      1          1          1
Iris-versicolor           6.6          3.0           4.4          1.4      1          1          1
Iris-versicolor           6.8          2.8           4.8          1.4      1          1          1
Iris-versicolor           6.7          3.0           5.0          1.7      1          1          1
Iris-versicolor           6.0          2.9           4.5          1.5      1          1          1
Iris-versicolor           5.7          2.6           3.5          1.0      1          1          1
Iris-versicolor           5.5          2.4           3.8          1.1      1          1          1
Iris-versicolor           5.5          2.4           3.7          1.0      1          1          1
Iris-versicolor           5.8          2.7           3.9          1.2      1          1          1
Iris-versicolor           6.0          2.7           5.1          1.6      1          1          1
Iris-versicolor           6.0          3.4           4.5          1.6      1          1          1
Iris-versicolor           6.7          3.1           4.7          1.5      1          1          1
Iris-versicolor           6.3          2.3           4.4          1.3      1          1          1
Iris-versicolor           5.6          3.0           4.1          1.3      1          1          1
Iris-versicolor           5.5          2.5           4.0          1.3      1          1          1
Iris-versicolor           5.5          2.6           4.4          1.2      1          1          1
Iris-versicolor           6.1          3.0           4.6          1.4      1          1          1
Iris-versicolor           5.8          2.6           4.0          1.2      1          1          1
Iris-versicolor           5.0          2.3           3.3          1.0      1          1          1
Iris-versicolor           5.6          2.7           4.2          1.3      1          1          1
Iris-versicolor           5.7          3.0           4.2          1.2      1          1          1
Iris-versicolor           5.7          2.9           4.2          1.3      1          1          1
Iris-versicolor           6.2          2.9           4.3          1.3      1          1          1
Iris-versicolor           5.1          2.5           3.0          1.1      1          1          1
Iris-versicolor           5.7          2.8           4.1          1.3      1          1          1
 Iris-virginica           6.3          3.3           6.0          2.5      2          2          1
 Iris-virginica           5.8          2.7           5.1          1.9      2          2          1
 Iris-virginica           7.1          3.0           5.9          2.1      2          2          1
 Iris-virginica           6.3          2.9           5.6          1.8      2          2          1
 Iris-virginica           7.6          3.0           6.6          2.1      2          2          1
 Iris-virginica           7.3          2.9           6.3          1.8      2          2          1
 Iris-virginica           6.7          2.5           5.8          1.8      2          2          1
 Iris-virginica           7.2          3.6           6.1          2.5      2          2          1
 Iris-virginica           6.5          3.2           5.1          2.0      2          2          1
 Iris-virginica           6.4          2.7           5.3          1.9      2          2          1
 Iris-virginica           6.8          3.0           5.5          2.1      2          2          1
 Iris-virginica           5.7          2.5           5.0          2.0      2          2          1
 Iris-virginica           5.8          2.8           5.1          2.4      2          2          1
 Iris-virginica           6.4          3.2           5.3          2.3      2          2          1
 Iris-virginica           6.5          3.0           5.5          1.8      2          2          1
 Iris-virginica           7.7          3.8           6.7          2.2      2          2          1
 Iris-virginica           7.7          2.6           6.9          2.3      2          2          1
 Iris-virginica           6.0          2.2           5.0          1.5      2          2          1
 Iris-virginica           6.9          3.2           5.7          2.3      2          2          1
 Iris-virginica           5.6          2.8           4.9          2.0      2          2          1
 Iris-virginica           7.7          2.8           6.7          2.0      2          2          1
 Iris-virginica           6.3          2.7           4.9          1.8      2          2          1
 Iris-virginica           6.7          3.3           5.7          2.1      2          2          1
 Iris-virginica           7.2          3.2           6.0          1.8      2          2          1
 Iris-virginica           6.2          2.8           4.8          1.8      2          2          1
 Iris-virginica           6.1          3.0           4.9          1.8      2          2          1
    Iris-setosa          40.7         30.2          55.0         45.3      0          0         -1
    Iris-setosa          50.0         30.6          30.4         20.0      0          0         -1
    Iris-setosa          50.2         30.5          60.4          3.8      0          0         -1
    Iris-setosa          40.7         30.2           5.0         20.3      0          0         -1
    Iris-setosa          50.0         30.3          30.9         40.0      0          0         -1
Iris-versicolor          60.6         20.9          40.6         77.7      1          1         -1
Iris-versicolor          50.9         30.0          70.0         61.0      1          1         -1
Iris-versicolor          50.9         30.2          81.0         31.8      1          1         -1
Iris-versicolor          50.4         30.0          40.5         15.0      1          1         -1
 Iris-virginica          60.5         30.0          58.0         20.2      2          2         -1
 Iris-virginica          40.9         20.5          40.5         17.0      2          2         -1
 Iris-virginica           6.4          2.8           5.6          2.1      2          2          1
 Iris-virginica           7.2          3.0           5.8          1.6      2          2          1
 Iris-virginica           7.9          3.8           6.4          2.0      2          2          1
 Iris-virginica           6.3          2.8           5.1          1.5      2          2          1
 Iris-virginica           6.1          2.6           5.6          1.4      2          2          1
 Iris-virginica           7.7          3.0           6.1          2.3      2          2          1
 Iris-virginica           6.3          3.4           5.6          2.4      2          2          1
 Iris-virginica           6.4          3.1           5.5          1.8      2          2          1
 Iris-virginica           6.0          3.0           4.8          1.8      2          2          1
 Iris-virginica           6.9          3.1           5.4          2.1      2          2          1
 Iris-virginica           6.7          3.1           5.6          2.4      2          2          1
 Iris-virginica           6.9          3.1           5.1          2.3      2          2          1
 Iris-virginica           5.8          2.7           5.1          1.9      2          2          1
 Iris-virginica           6.8          3.2           5.9          2.3      2          2          1
 Iris-virginica           6.7          3.0           5.2          2.3      2          2          1
 Iris-virginica           6.3          2.5           5.0          1.9      2          2          1
 Iris-virginica           6.5          3.0           5.2          2.0      2          2          1
 Iris-virginica           6.2          3.4           5.4          2.3      2          2          1
 Iris-virginica           5.9          3.0           5.1          1.8      2          2          1
    Iris-setosa           4.9          3.0           1.4          0.2      0          0          1
Iris-versicolor          60.3         20.5          43.0         27.4      1          1         -1
 Iris-virginica          70.4         20.8          61.0         19.7      2          2         -1
 Iris-virginica          64.0         28.0          56.6         22.0      2          2         -1
 Iris-virginica          67.0         33.0          57.0         25.5      2          2         -1

Jumlah outlier: 15

Data Outlier:
          class  sepal_length  sepal_width  petal_length  petal_width  Class  class_num
    Iris-setosa          40.7         30.2          55.0         45.3      0          0
    Iris-setosa          50.0         30.6          30.4         20.0      0          0
    Iris-setosa          50.2         30.5          60.4          3.8      0          0
    Iris-setosa          40.7         30.2           5.0         20.3      0          0
    Iris-setosa          50.0         30.3          30.9         40.0      0          0
Iris-versicolor          60.6         20.9          40.6         77.7      1          1
Iris-versicolor          50.9         30.0          70.0         61.0      1          1
Iris-versicolor          50.9         30.2          81.0         31.8      1          1
Iris-versicolor          50.4         30.0          40.5         15.0      1          1
 Iris-virginica          60.5         30.0          58.0         20.2      2          2
 Iris-virginica          40.9         20.5          40.5         17.0      2          2
Iris-versicolor          60.3         20.5          43.0         27.4      1          1
 Iris-virginica          70.4         20.8          61.0         19.7      2          2
 Iris-virginica          64.0         28.0          56.6         22.0      2          2
 Iris-virginica          67.0         33.0          57.0         25.5      2          2

Jumlah data setelah dihapus :  135

Data tidak outlier :
          class  sepal_length  sepal_width  petal_length  petal_width  Class  class_num
    Iris-setosa           5.1          3.5           1.4          0.2      0          0
    Iris-setosa           4.6          3.1           1.5          0.2      0          0
    Iris-setosa           5.4          3.9           1.7          0.4      0          0
    Iris-setosa           4.6          3.4           1.4          0.3      0          0
    Iris-setosa           5.0          3.4           1.5          0.2      0          0
    Iris-setosa           4.4          2.9           1.4          0.2      0          0
    Iris-setosa           4.9          3.1           1.5          0.1      0          0
    Iris-setosa           5.4          3.7           1.5          0.2      0          0
    Iris-setosa           4.8          3.4           1.6          0.2      0          0
    Iris-setosa           4.8          3.0           1.4          0.1      0          0
    Iris-setosa           4.3          3.0           1.1          0.1      0          0
    Iris-setosa           5.8          4.0           1.2          0.2      0          0
    Iris-setosa           5.7          4.4           1.5          0.4      0          0
    Iris-setosa           5.4          3.9           1.3          0.4      0          0
    Iris-setosa           5.1          3.5           1.4          0.3      0          0
    Iris-setosa           5.7          3.8           1.7          0.3      0          0
    Iris-setosa           5.1          3.8           1.5          0.3      0          0
    Iris-setosa           5.4          3.4           1.7          0.2      0          0
    Iris-setosa           5.1          3.7           1.5          0.4      0          0
    Iris-setosa           4.6          3.6           1.0          0.2      0          0
    Iris-setosa           5.1          3.3           1.7          0.5      0          0
    Iris-setosa           4.8          3.4           1.9          0.2      0          0
    Iris-setosa           5.0          3.0           1.6          0.2      0          0
    Iris-setosa           5.0          3.4           1.6          0.4      0          0
    Iris-setosa           5.2          3.4           1.4          0.2      0          0
    Iris-setosa           4.8          3.1           1.6          0.2      0          0
    Iris-setosa           5.4          3.4           1.5          0.4      0          0
    Iris-setosa           5.2          4.1           1.5          0.1      0          0
    Iris-setosa           5.5          4.2           1.4          0.2      0          0
    Iris-setosa           4.9          3.1           1.5          0.1      0          0
    Iris-setosa           5.0          3.2           1.2          0.2      0          0
    Iris-setosa           5.5          3.5           1.3          0.2      0          0
    Iris-setosa           4.9          3.1           1.5          0.1      0          0
    Iris-setosa           4.4          3.0           1.3          0.2      0          0
    Iris-setosa           5.1          3.4           1.5          0.2      0          0
    Iris-setosa           5.0          3.5           1.3          0.3      0          0
    Iris-setosa           4.5          2.3           1.3          0.3      0          0
    Iris-setosa           4.4          3.2           1.3          0.2      0          0
    Iris-setosa           5.0          3.5           1.6          0.6      0          0
    Iris-setosa           5.1          3.8           1.9          0.4      0          0
    Iris-setosa           4.8          3.0           1.4          0.3      0          0
    Iris-setosa           5.1          3.8           1.6          0.2      0          0
    Iris-setosa           4.6          3.2           1.4          0.2      0          0
    Iris-setosa           5.3          3.7           1.5          0.2      0          0
Iris-versicolor           7.0          3.2           4.7          1.4      1          1
Iris-versicolor           6.4          3.2           4.5          1.5      1          1
Iris-versicolor           6.9          3.1           4.9          1.5      1          1
Iris-versicolor           5.5          2.3           4.0          1.3      1          1
Iris-versicolor           6.5          2.8           4.6          1.5      1          1
Iris-versicolor           5.7          2.8           4.5          1.3      1          1
Iris-versicolor           6.3          3.3           4.7          1.6      1          1
Iris-versicolor           4.9          2.4           3.3          1.0      1          1
Iris-versicolor           5.2          2.7           3.9          1.4      1          1
Iris-versicolor           5.0          2.0           3.5          1.0      1          1
Iris-versicolor           6.0          2.2           4.0          1.0      1          1
Iris-versicolor           6.1          2.9           4.7          1.4      1          1
Iris-versicolor           5.6          2.9           3.6          1.3      1          1
Iris-versicolor           6.7          3.1           4.4          1.4      1          1
Iris-versicolor           5.6          3.0           4.5          1.5      1          1
Iris-versicolor           5.8          2.7           4.1          1.0      1          1
Iris-versicolor           6.2          2.2           4.5          1.5      1          1
Iris-versicolor           5.6          2.5           3.9          1.1      1          1
Iris-versicolor           6.1          2.8           4.0          1.3      1          1
Iris-versicolor           6.1          2.8           4.7          1.2      1          1
Iris-versicolor           6.4          2.9           4.3          1.3      1          1
Iris-versicolor           6.6          3.0           4.4          1.4      1          1
Iris-versicolor           6.8          2.8           4.8          1.4      1          1
Iris-versicolor           6.7          3.0           5.0          1.7      1          1
Iris-versicolor           6.0          2.9           4.5          1.5      1          1
Iris-versicolor           5.7          2.6           3.5          1.0      1          1
Iris-versicolor           5.5          2.4           3.8          1.1      1          1
Iris-versicolor           5.5          2.4           3.7          1.0      1          1
Iris-versicolor           5.8          2.7           3.9          1.2      1          1
Iris-versicolor           6.0          2.7           5.1          1.6      1          1
Iris-versicolor           6.0          3.4           4.5          1.6      1          1
Iris-versicolor           6.7          3.1           4.7          1.5      1          1
Iris-versicolor           6.3          2.3           4.4          1.3      1          1
Iris-versicolor           5.6          3.0           4.1          1.3      1          1
Iris-versicolor           5.5          2.5           4.0          1.3      1          1
Iris-versicolor           5.5          2.6           4.4          1.2      1          1
Iris-versicolor           6.1          3.0           4.6          1.4      1          1
Iris-versicolor           5.8          2.6           4.0          1.2      1          1
Iris-versicolor           5.0          2.3           3.3          1.0      1          1
Iris-versicolor           5.6          2.7           4.2          1.3      1          1
Iris-versicolor           5.7          3.0           4.2          1.2      1          1
Iris-versicolor           5.7          2.9           4.2          1.3      1          1
Iris-versicolor           6.2          2.9           4.3          1.3      1          1
Iris-versicolor           5.1          2.5           3.0          1.1      1          1
Iris-versicolor           5.7          2.8           4.1          1.3      1          1
 Iris-virginica           6.3          3.3           6.0          2.5      2          2
 Iris-virginica           5.8          2.7           5.1          1.9      2          2
 Iris-virginica           7.1          3.0           5.9          2.1      2          2
 Iris-virginica           6.3          2.9           5.6          1.8      2          2
 Iris-virginica           7.6          3.0           6.6          2.1      2          2
 Iris-virginica           7.3          2.9           6.3          1.8      2          2
 Iris-virginica           6.7          2.5           5.8          1.8      2          2
 Iris-virginica           7.2          3.6           6.1          2.5      2          2
 Iris-virginica           6.5          3.2           5.1          2.0      2          2
 Iris-virginica           6.4          2.7           5.3          1.9      2          2
 Iris-virginica           6.8          3.0           5.5          2.1      2          2
 Iris-virginica           5.7          2.5           5.0          2.0      2          2
 Iris-virginica           5.8          2.8           5.1          2.4      2          2
 Iris-virginica           6.4          3.2           5.3          2.3      2          2
 Iris-virginica           6.5          3.0           5.5          1.8      2          2
 Iris-virginica           7.7          3.8           6.7          2.2      2          2
 Iris-virginica           7.7          2.6           6.9          2.3      2          2
 Iris-virginica           6.0          2.2           5.0          1.5      2          2
 Iris-virginica           6.9          3.2           5.7          2.3      2          2
 Iris-virginica           5.6          2.8           4.9          2.0      2          2
 Iris-virginica           7.7          2.8           6.7          2.0      2          2
 Iris-virginica           6.3          2.7           4.9          1.8      2          2
 Iris-virginica           6.7          3.3           5.7          2.1      2          2
 Iris-virginica           7.2          3.2           6.0          1.8      2          2
 Iris-virginica           6.2          2.8           4.8          1.8      2          2
 Iris-virginica           6.1          3.0           4.9          1.8      2          2
 Iris-virginica           6.4          2.8           5.6          2.1      2          2
 Iris-virginica           7.2          3.0           5.8          1.6      2          2
 Iris-virginica           7.9          3.8           6.4          2.0      2          2
 Iris-virginica           6.3          2.8           5.1          1.5      2          2
 Iris-virginica           6.1          2.6           5.6          1.4      2          2
 Iris-virginica           7.7          3.0           6.1          2.3      2          2
 Iris-virginica           6.3          3.4           5.6          2.4      2          2
 Iris-virginica           6.4          3.1           5.5          1.8      2          2
 Iris-virginica           6.0          3.0           4.8          1.8      2          2
 Iris-virginica           6.9          3.1           5.4          2.1      2          2
 Iris-virginica           6.7          3.1           5.6          2.4      2          2
 Iris-virginica           6.9          3.1           5.1          2.3      2          2
 Iris-virginica           5.8          2.7           5.1          1.9      2          2
 Iris-virginica           6.8          3.2           5.9          2.3      2          2
 Iris-virginica           6.7          3.0           5.2          2.3      2          2
 Iris-virginica           6.3          2.5           5.0          1.9      2          2
 Iris-virginica           6.5          3.0           5.2          2.0      2          2
 Iris-virginica           6.2          3.4           5.4          2.3      2          2
 Iris-virginica           5.9          3.0           5.1          1.8      2          2
    Iris-setosa           4.9          3.0           1.4          0.2      0          0
</pre></div>
</div>
</div>
</div>
<p>Kode di atas melakukan deteksi outlier menggunakan algoritma Local Outlier Factor (LOF) pada dataset yang berisi data iris. Pertama, kode memilih kolom-kolom numerik yang relevan yaitu ‘sepal_length’, ‘sepal_width’, ‘petal_length’, dan ‘petal_width’ dari dataframe yang telah digabungkan (df_combined), kemudian mengambil nilai-nilai tersebut ke dalam variabel numpy array bernama data_values.</p>
<p>Selanjutnya, objek LOF diinisialisasi dengan parameter n_neighbors=90, yang berarti algoritma akan mempertimbangkan 90 tetangga terdekat untuk menghitung kepadatan lokal setiap titik.</p>
<p>Metode fit_predict() dipanggil untuk mengklasifikasikan tiap titik sebagai inlier (diberi label 1) atau outlier (diberi label -1). Label yang dihasilkan ditambahkan ke dataframe df_combined dalam kolom baru bernama ‘LOF_label’.</p>
<p>Hasil akhir kemudian dicetak, menampilkan keseluruhan data beserta ID dan kelas, serta menghitung dan mencetak jumlah outlier yang terdeteksi. Data yang dianggap inlier difilter ke dalam dataframe df_filtered, sedangkan data outlier disimpan dalam variabel outliers. Kode kemudian mencetak informasi mengenai data outlier, jumlah data yang tersisa setelah outlier dihapus, dan tampilan data yang tidak dianggap outlier.</p>
</section>
<section id="menghitung-akurasi-dari-data">
<h2><strong>Menghitung Akurasi dari Data</strong><a class="headerlink" href="#menghitung-akurasi-dari-data" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">train_test_split</span></code></strong> : Fungsi ini digunakan untuk membagi dataset menjadi data pelatihan (training) dan data pengujian (testing), sehingga dapat melatih model pada sebagian data dan mengevaluasi performanya pada data yang belum pernah dilihat sebelumnya.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">KFold</span></code></strong> : class yang menyediakan metode k-fold cross-validation ( teknik untuk membagi dataset )</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">KNeighborsClassifier</span></code></strong> : algoritma klasifikasi yang menggunakan metode k-nearest neighbors (K-NN) untuk mengklasifikasikan sampel berdasarkan jarak ke tetangga terdekat.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LocalOutlierFactor</span></code></strong> : Kelas ini mengimplementasikan algoritma deteksi outlier berbasis kepadatan lokal, yang berguna untuk mengidentifikasi data yang tidak konsisten atau anomali dalam dataset.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">Pipeline</span></code></strong> : Kelas ini memungkinkan Anda untuk menggabungkan beberapa langkah (misalnya, praproses data dan pelatihan model) menjadi satu alur kerja yang konsisten, sehingga memudahkan pengelolaan dan validasi model.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">StandardScaler</span></code></strong> : Berfungsi untuk menstandardisasi fitur dengan menghilangkan rata-rata dan menskalakan ke unit varians, yang membantu dalam mengurangi bias karena perbedaan skala antar fitur.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">LabelEncoder</span></code></strong> : Digunakan untuk mengubah label kategori menjadi format numerik yang dapat diproses oleh algoritma machine learning.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">Normalizer</span></code></strong> : Berfungsi untuk menormalkan setiap sampel (biasanya dengan membaginya dengan normanya) sehingga data memiliki skala yang konsisten, yang berguna untuk model yang sensitif terhadap skala fitur.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">accuracy_score</span></code></strong> : Fungsi ini menghitung akurasi prediksi model dengan membandingkan label sebenarnya dengan label yang diprediksi.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">classification_report</span></code></strong> : Memberikan laporan lengkap mengenai metrik evaluasi (seperti precision, recall, dan F1-score) untuk masing-masing kelas, sehingga Anda dapat mengevaluasi performa model secara mendalam.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">DecisionBoundaryDisplay</span></code></strong> : Kelas ini membantu dalam visualisasi batas keputusan dari model, yang berguna untuk memahami bagaimana model memisahkan kelas-kelas yang berbeda dalam ruang fitur.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span> <span class="p">,</span> <span class="n">KFold</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">LocalOutlierFactor</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">LabelEncoder</span><span class="p">,</span> <span class="n">Normalizer</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">classification_report</span>
<span class="kn">from</span> <span class="nn">sklearn.inspection</span> <span class="kn">import</span> <span class="n">DecisionBoundaryDisplay</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">df_combined</span><span class="p">[</span><span class="n">features_columns</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df_combined</span><span class="p">[</span><span class="s2">&quot;class&quot;</span><span class="p">]</span>

<span class="c1"># Encode label kelas ke numerik</span>
<span class="n">label_encoder</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">y_encoded</span> <span class="o">=</span> <span class="n">label_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># Menerapkan LOF untuk deteksi outlier</span>
<span class="n">lof</span> <span class="o">=</span> <span class="n">LocalOutlierFactor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">contamination</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">outlier_labels</span> <span class="o">=</span> <span class="n">lof</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">df_combined</span><span class="p">[</span><span class="s2">&quot;LOF_label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">outlier_labels</span>

<span class="c1"># Pisahkan data dengan outlier dan tanpa outlier</span>
<span class="n">df_cleaned</span> <span class="o">=</span> <span class="n">df_combined</span><span class="p">[</span><span class="n">df_combined</span><span class="p">[</span><span class="s2">&quot;LOF_label&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;LOF_label&quot;</span><span class="p">])</span>

<span class="c1"># Membagi data menjadi training (80%) dan testing (20%)</span>
<span class="n">X_train_all</span><span class="p">,</span> <span class="n">X_test_all</span><span class="p">,</span> <span class="n">y_train_all</span><span class="p">,</span> <span class="n">y_test_all</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y_encoded</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>

<span class="n">X_train_clean</span><span class="p">,</span> <span class="n">X_test_clean</span><span class="p">,</span> <span class="n">y_train_clean</span><span class="p">,</span> <span class="n">y_test_clean</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">df_cleaned</span><span class="p">[</span><span class="n">features_columns</span><span class="p">],</span>
    <span class="n">label_encoder</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">df_cleaned</span><span class="p">[</span><span class="s2">&quot;class&quot;</span><span class="p">]),</span>
    <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>

<span class="c1"># Pipeline dengan StandardScaler dan KNN</span>
<span class="n">knn_pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s2">&quot;scaler&quot;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
    <span class="p">(</span><span class="s2">&quot;knn&quot;</span><span class="p">,</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">11</span><span class="p">))</span>
<span class="p">])</span>

<span class="c1"># Latih model pada data dengan outlier</span>
<span class="n">knn_pipeline</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_all</span><span class="p">,</span> <span class="n">y_train_all</span><span class="p">)</span>
<span class="n">y_pred_all</span> <span class="o">=</span> <span class="n">knn_pipeline</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_all</span><span class="p">)</span>
<span class="n">accuracy_all</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test_all</span><span class="p">,</span> <span class="n">y_pred_all</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Akurasi dengan outlier:&quot;</span><span class="p">,</span> <span class="n">accuracy_all</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test_all</span><span class="p">,</span> <span class="n">y_pred_all</span><span class="p">,</span> <span class="n">target_names</span><span class="o">=</span><span class="n">label_encoder</span><span class="o">.</span><span class="n">classes_</span><span class="p">))</span>

<span class="c1"># Latih model pada data tanpa outlier</span>
<span class="n">knn_pipeline</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_clean</span><span class="p">,</span> <span class="n">y_train_clean</span><span class="p">)</span>
<span class="n">y_pred_clean</span> <span class="o">=</span> <span class="n">knn_pipeline</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_clean</span><span class="p">)</span>
<span class="n">accuracy_clean</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test_clean</span><span class="p">,</span> <span class="n">y_pred_clean</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Akurasi tanpa outlier:&quot;</span><span class="p">,</span> <span class="n">accuracy_clean</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test_clean</span><span class="p">,</span> <span class="n">y_pred_clean</span><span class="p">,</span> <span class="n">target_names</span><span class="o">=</span><span class="n">label_encoder</span><span class="o">.</span><span class="n">classes_</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Akurasi dengan outlier: 0.9333333333333333
                 precision    recall  f1-score   support

    Iris-setosa       1.00      0.91      0.95        11
Iris-versicolor       1.00      0.90      0.95        10
 Iris-virginica       0.82      1.00      0.90         9

       accuracy                           0.93        30
      macro avg       0.94      0.94      0.93        30
   weighted avg       0.95      0.93      0.93        30

Akurasi tanpa outlier: 1.0
                 precision    recall  f1-score   support

    Iris-setosa       1.00      1.00      1.00        11
Iris-versicolor       1.00      1.00      1.00         8
 Iris-virginica       1.00      1.00      1.00         8

       accuracy                           1.00        27
      macro avg       1.00      1.00      1.00        27
   weighted avg       1.00      1.00      1.00        27
</pre></div>
</div>
</div>
</div>
<p>Kode diatas untuk menghitung akurasi data, dimulai dengan pemisahan fitur (X) dan target (y) dari dataframe gabungan, di mana fitur diambil dari kolom numerik seperti ‘sepal_length’, ‘sepal_width’, ‘petal_length’, dan ‘petal_width’, sedangkan target merupakan kolom “class”.</p>
<p>Label kelas kemudian diubah menjadi format numerik menggunakan LabelEncoder sehingga algoritma bisa mengolahnya. Selanjutnya, algoritma deteksi outlier Local Outlier Factor (LOF) diterapkan pada data fitur X dengan parameter n_neighbors=90 dan contamination=0.1, yang menghasilkan label outlier untuk setiap sampel (1 untuk inlier dan -1 untuk outlier) dan menambahkannya sebagai kolom baru “LOF_label” pada dataframe. Berdasarkan label ini, data yang dianggap tidak mengandung outlier (LOF_label == 1) difilter ke dalam dataframe baru, df_cleaned.</p>
<p>Selanjutnya, kedua dataset—data asli yang mencakup outlier dan data yang telah dibersihkan dari outlier—dibagi menjadi data training (80%) dan data testing (20%) menggunakan fungsi train_test_split, dengan menjaga konsistensi pembagian melalui random_state=42. Untuk membangun model klasifikasi, dibuat pipeline yang menggabungkan StandardScaler untuk melakukan standardisasi fitur sehingga skala data menjadi konsisten, serta KNeighborsClassifier dengan n_neighbors=11 sebagai algoritma pengklasifikasi.</p>
<p>Model tersebut pertama kali dilatih menggunakan data asli (dengan outlier) dan hasil prediksi pada data testing dievaluasi dengan menghitung akurasi dan menghasilkan classification report yang mencakup metrik seperti precision, recall, dan F1-score. Kemudian, proses pelatihan dan evaluasi yang sama dilakukan pada data yang telah dibersihkan dari outlier, sehingga perbandingan performa model pada kedua kondisi (dengan dan tanpa outlier) dapat dilakukan.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">LocalOutlierFactor</span><span class="p">,</span> <span class="n">KNeighborsClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">LabelEncoder</span>
<span class="kn">from</span> <span class="nn">sklearn.inspection</span> <span class="kn">import</span> <span class="n">DecisionBoundaryDisplay</span>


<span class="c1"># Encode label kelas menjadi numerik</span>
<span class="n">label_encoder</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">df_combined</span><span class="p">[</span><span class="s2">&quot;class_encoded&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_combined</span><span class="p">[</span><span class="s2">&quot;class&quot;</span><span class="p">])</span>

<span class="c1"># Deteksi outlier berbasis fitur sepal dan hapus data yang terdeteksi sebagai outlier</span>
<span class="n">sepal_features</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;sepal_length&quot;</span><span class="p">,</span> <span class="s2">&quot;sepal_width&quot;</span><span class="p">]</span>
<span class="n">lof</span> <span class="o">=</span> <span class="n">LocalOutlierFactor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">contamination</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">outlier_labels</span> <span class="o">=</span> <span class="n">lof</span><span class="o">.</span><span class="n">fit_predict</span><span class="p">(</span><span class="n">df_combined</span><span class="p">[</span><span class="n">sepal_features</span><span class="p">])</span>
<span class="n">df_cleaned</span> <span class="o">=</span> <span class="n">df_combined</span><span class="p">[</span><span class="n">outlier_labels</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Persiapkan data untuk visualisasi</span>
<span class="c1"># Data untuk fitur sepal</span>
<span class="n">X_sepal</span> <span class="o">=</span> <span class="n">df_cleaned</span><span class="p">[</span><span class="n">sepal_features</span><span class="p">]</span>
<span class="n">y_sepal</span> <span class="o">=</span> <span class="n">df_cleaned</span><span class="p">[</span><span class="s2">&quot;class_encoded&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Data untuk fitur petal</span>
<span class="n">petal_features</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;petal_length&quot;</span><span class="p">,</span> <span class="s2">&quot;petal_width&quot;</span><span class="p">]</span>
<span class="n">X_petal</span> <span class="o">=</span> <span class="n">df_cleaned</span><span class="p">[</span><span class="n">petal_features</span><span class="p">]</span>
<span class="n">y_petal</span> <span class="o">=</span> <span class="n">df_cleaned</span><span class="p">[</span><span class="s2">&quot;class_encoded&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Split data training dan testing untuk masing-masing</span>
<span class="n">X_train_sepal</span><span class="p">,</span> <span class="n">X_test_sepal</span><span class="p">,</span> <span class="n">y_train_sepal</span><span class="p">,</span> <span class="n">y_test_sepal</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X_sepal</span><span class="p">,</span> <span class="n">y_sepal</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>
<span class="n">X_train_petal</span><span class="p">,</span> <span class="n">X_test_petal</span><span class="p">,</span> <span class="n">y_train_petal</span><span class="p">,</span> <span class="n">y_test_petal</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X_petal</span><span class="p">,</span> <span class="n">y_petal</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>

<span class="c1"># --- Pelatihan Model &amp; Visualisasi Decision Boundary ---</span>
<span class="c1"># Buat pipeline KNN dengan StandardScaler, gunakan bobot &quot;uniform&quot; (default)</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s2">&quot;scaler&quot;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
    <span class="p">(</span><span class="s2">&quot;knn&quot;</span><span class="p">,</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="s2">&quot;uniform&quot;</span><span class="p">))</span>
<span class="p">])</span>

<span class="c1"># Buat figure dengan 1 baris dan 2 kolom: kiri untuk sepal, kanan untuk petal</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Visualisasi Decision Boundary untuk fitur sepal (gambar di kiri)</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_sepal</span><span class="p">,</span> <span class="n">y_train_sepal</span><span class="p">)</span>
<span class="n">disp_sepal</span> <span class="o">=</span> <span class="n">DecisionBoundaryDisplay</span><span class="o">.</span><span class="n">from_estimator</span><span class="p">(</span>
    <span class="n">clf</span><span class="p">,</span>
    <span class="n">X_test_sepal</span><span class="p">,</span>
    <span class="n">response_method</span><span class="o">=</span><span class="s2">&quot;predict&quot;</span><span class="p">,</span>
    <span class="n">plot_method</span><span class="o">=</span><span class="s2">&quot;pcolormesh&quot;</span><span class="p">,</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="n">sepal_features</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="n">sepal_features</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">shading</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;coolwarm&quot;</span>  <span class="c1"># Ubah colormap sesuai keinginan</span>
<span class="p">)</span>
<span class="n">scatter_sepal</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">X_train_sepal</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_train_sepal</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">c</span><span class="o">=</span><span class="n">y_train_sepal</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Set1&quot;</span>  <span class="c1"># Ubah colormap scatter jika diperlukan</span>
<span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
    <span class="n">scatter_sepal</span><span class="o">.</span><span class="n">legend_elements</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">label_encoder</span><span class="o">.</span><span class="n">classes_</span><span class="p">,</span>
    <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower left&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Classes&quot;</span>
<span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Decision Boundary - Sepal Features&quot;</span><span class="p">)</span>

<span class="c1"># Visualisasi Decision Boundary untuk fitur petal (gambar di kanan)</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_petal</span><span class="p">,</span> <span class="n">y_train_petal</span><span class="p">)</span>
<span class="n">disp_petal</span> <span class="o">=</span> <span class="n">DecisionBoundaryDisplay</span><span class="o">.</span><span class="n">from_estimator</span><span class="p">(</span>
    <span class="n">clf</span><span class="p">,</span>
    <span class="n">X_test_petal</span><span class="p">,</span>
    <span class="n">response_method</span><span class="o">=</span><span class="s2">&quot;predict&quot;</span><span class="p">,</span>
    <span class="n">plot_method</span><span class="o">=</span><span class="s2">&quot;pcolormesh&quot;</span><span class="p">,</span>
    <span class="n">xlabel</span><span class="o">=</span><span class="n">petal_features</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">ylabel</span><span class="o">=</span><span class="n">petal_features</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">shading</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;coolwarm&quot;</span>
<span class="p">)</span>
<span class="n">scatter_petal</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
    <span class="n">X_train_petal</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X_train_petal</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">c</span><span class="o">=</span><span class="n">y_train_petal</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Set1&quot;</span>
<span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
    <span class="n">scatter_petal</span><span class="o">.</span><span class="n">legend_elements</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">label_encoder</span><span class="o">.</span><span class="n">classes_</span><span class="p">,</span>
    <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower left&quot;</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Classes&quot;</span>
<span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Decision Boundary - Petal Features&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/9494859d738bc66211263442b4d7be9e397c656a34e95f6164258b59764e8671.png" src="_images/9494859d738bc66211263442b4d7be9e397c656a34e95f6164258b59764e8671.png" />
</div>
</div>
</section>
<section id="implementasi-naive-bayes">
<h2><strong>Implementasi Naive Bayes</strong><a class="headerlink" href="#implementasi-naive-bayes" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">confusion_matrix</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Asumsikan df_merged sudah ada dari kode sebelumnya</span>

<span class="c1"># Encode label kelas ke numerik</span>
<span class="n">label_encoder</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
<span class="n">df_combined</span><span class="p">[</span><span class="s2">&quot;class_encoded&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label_encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_combined</span><span class="p">[</span><span class="s2">&quot;class&quot;</span><span class="p">])</span>

<span class="c1"># Data dengan outlier</span>
<span class="n">X_all</span> <span class="o">=</span> <span class="n">df_combined</span><span class="p">[</span><span class="n">features_columns</span><span class="p">]</span>
<span class="n">y_all</span> <span class="o">=</span> <span class="n">df_combined</span><span class="p">[</span><span class="s2">&quot;class_encoded&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># Pastikan dalam bentuk array numpy</span>

<span class="c1"># Data tanpa outlier</span>
<span class="n">df_cleaned</span> <span class="o">=</span> <span class="n">df_combined</span><span class="p">[</span><span class="n">df_combined</span><span class="p">[</span><span class="s2">&quot;LOF_label&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;LOF_label&quot;</span><span class="p">])</span> <span class="c1"># Changed &#39;outlier&#39; to &#39;LOF_label&#39; to match the actual column name</span>
<span class="n">X_clean</span> <span class="o">=</span> <span class="n">df_cleaned</span><span class="p">[</span><span class="n">features_columns</span><span class="p">]</span>
<span class="n">y_clean</span> <span class="o">=</span> <span class="n">df_cleaned</span><span class="p">[</span><span class="s2">&quot;class_encoded&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># Pastikan dalam bentuk array numpy</span>

<span class="c1"># Split data dengan outlier</span>
<span class="n">X_train_all</span><span class="p">,</span> <span class="n">X_test_all</span><span class="p">,</span> <span class="n">y_train_all</span><span class="p">,</span> <span class="n">y_test_all</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X_all</span><span class="p">,</span> <span class="n">y_all</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Split data tanpa outlier</span>
<span class="n">X_train_clean</span><span class="p">,</span> <span class="n">X_test_clean</span><span class="p">,</span> <span class="n">y_train_clean</span><span class="p">,</span> <span class="n">y_test_clean</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X_clean</span><span class="p">,</span> <span class="n">y_clean</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Inisialisasi model Naive Bayes</span>
<span class="n">gnb</span> <span class="o">=</span> <span class="n">GaussianNB</span><span class="p">()</span>

<span class="c1"># Latih dan uji model dengan outlier</span>
<span class="n">y_pred_all</span> <span class="o">=</span> <span class="n">gnb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_all</span><span class="p">,</span> <span class="n">y_train_all</span><span class="p">)</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_all</span><span class="p">)</span>
<span class="n">mislabeled_all</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_test_all</span> <span class="o">!=</span> <span class="n">y_pred_all</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">accuracy_all</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test_all</span><span class="p">,</span> <span class="n">y_pred_all</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of mislabeled points with outliers out of a total </span><span class="si">%d</span><span class="s2"> points : </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">X_test_all</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mislabeled_all</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy with outliers: </span><span class="si">%.2f%%</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">accuracy_all</span> <span class="o">*</span> <span class="mi">100</span><span class="p">))</span>

<span class="c1"># Menampilkan label yang salah pada data dengan outlier</span>
<span class="n">mislabeled_indices_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y_test_all</span> <span class="o">!=</span> <span class="n">y_pred_all</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mislabeled points with outliers:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">mislabeled_indices_all</span><span class="p">:</span>
    <span class="n">true_label</span> <span class="o">=</span> <span class="n">label_encoder</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">y_test_all</span><span class="p">[</span><span class="n">i</span><span class="p">])])[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">predicted_label</span> <span class="o">=</span> <span class="n">label_encoder</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">y_pred_all</span><span class="p">[</span><span class="n">i</span><span class="p">])])[</span><span class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Index: </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">, True Label: </span><span class="si">{</span><span class="n">true_label</span><span class="si">}</span><span class="s2">, Predicted: </span><span class="si">{</span><span class="n">predicted_label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="c1"># Latih dan uji model tanpa outlier</span>
<span class="n">y_pred_clean</span> <span class="o">=</span> <span class="n">gnb</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_clean</span><span class="p">,</span> <span class="n">y_train_clean</span><span class="p">)</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_clean</span><span class="p">)</span>
<span class="n">mislabeled_clean</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_test_clean</span> <span class="o">!=</span> <span class="n">y_pred_clean</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">accuracy_clean</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test_clean</span><span class="p">,</span> <span class="n">y_pred_clean</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of mislabeled points without outliers out of a total </span><span class="si">%d</span><span class="s2"> points : </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">X_test_clean</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mislabeled_clean</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Accuracy without outliers: </span><span class="si">%.2f%%</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">accuracy_clean</span> <span class="o">*</span> <span class="mi">100</span><span class="p">))</span>

<span class="c1"># Menampilkan label yang salah pada data tanpa outlier</span>
<span class="n">mislabeled_indices_clean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">y_test_clean</span> <span class="o">!=</span> <span class="n">y_pred_clean</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mislabeled points without outliers:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">mislabeled_indices_clean</span><span class="p">:</span>
    <span class="n">true_label</span> <span class="o">=</span> <span class="n">label_encoder</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">y_test_clean</span><span class="p">[</span><span class="n">i</span><span class="p">])])[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">predicted_label</span> <span class="o">=</span> <span class="n">label_encoder</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">y_pred_clean</span><span class="p">[</span><span class="n">i</span><span class="p">])])[</span><span class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Index: </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">, True Label: </span><span class="si">{</span><span class="n">true_label</span><span class="si">}</span><span class="s2">, Predicted: </span><span class="si">{</span><span class="n">predicted_label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Visualisasi Confusion Matrix dengan garis pembatas</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test_all</span><span class="p">,</span> <span class="n">y_pred_all</span><span class="p">),</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">,</span>
            <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;coolwarm&quot;</span><span class="p">,</span>  <span class="c1"># Ganti colormap di sini</span>
            <span class="n">xticklabels</span><span class="o">=</span><span class="n">label_encoder</span><span class="o">.</span><span class="n">classes_</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="n">label_encoder</span><span class="o">.</span><span class="n">classes_</span><span class="p">,</span>
            <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Confusion Matrix with Outliers&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Predicted Label&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;True Label&quot;</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test_clean</span><span class="p">,</span> <span class="n">y_pred_clean</span><span class="p">),</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;d&quot;</span><span class="p">,</span>
            <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;coolwarm&quot;</span><span class="p">,</span>  <span class="c1"># Ganti colormap di sini</span>
            <span class="n">xticklabels</span><span class="o">=</span><span class="n">label_encoder</span><span class="o">.</span><span class="n">classes_</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="n">label_encoder</span><span class="o">.</span><span class="n">classes_</span><span class="p">,</span>
            <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Confusion Matrix without Outliers&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Predicted Label&quot;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;True Label&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of mislabeled points with outliers out of a total 30 points : 20
Accuracy with outliers: 33.33%
Mislabeled points with outliers:
Index: 0, True Label: Iris-versicolor, Predicted: Iris-setosa
Index: 2, True Label: Iris-setosa, Predicted: Iris-versicolor
Index: 3, True Label: Iris-versicolor, Predicted: Iris-setosa
Index: 4, True Label: Iris-versicolor, Predicted: Iris-setosa
Index: 6, True Label: Iris-versicolor, Predicted: Iris-setosa
Index: 7, True Label: Iris-virginica, Predicted: Iris-setosa
Index: 8, True Label: Iris-versicolor, Predicted: Iris-setosa
Index: 9, True Label: Iris-versicolor, Predicted: Iris-setosa
Index: 10, True Label: Iris-virginica, Predicted: Iris-setosa
Index: 15, True Label: Iris-versicolor, Predicted: Iris-setosa
Index: 16, True Label: Iris-virginica, Predicted: Iris-setosa
Index: 17, True Label: Iris-versicolor, Predicted: Iris-setosa
Index: 18, True Label: Iris-versicolor, Predicted: Iris-setosa
Index: 19, True Label: Iris-virginica, Predicted: Iris-setosa
Index: 21, True Label: Iris-virginica, Predicted: Iris-setosa
Index: 23, True Label: Iris-virginica, Predicted: Iris-setosa
Index: 24, True Label: Iris-virginica, Predicted: Iris-setosa
Index: 26, True Label: Iris-virginica, Predicted: Iris-setosa
Index: 27, True Label: Iris-virginica, Predicted: Iris-setosa
Index: 28, True Label: Iris-versicolor, Predicted: Iris-setosa

Number of mislabeled points without outliers out of a total 27 points : 2
Accuracy without outliers: 92.59%
Mislabeled points without outliers:
Index: 1, True Label: Iris-versicolor, Predicted: Iris-virginica
Index: 14, True Label: Iris-virginica, Predicted: Iris-versicolor
</pre></div>
</div>
<img alt="_images/0ef448740aa38f83c17461b11bff2924c62be3b3254101a9d0d5c5ba438251ab.png" src="_images/0ef448740aa38f83c17461b11bff2924c62be3b3254101a9d0d5c5ba438251ab.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Deteksi_Outlier.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong>Deteksi Outlier</strong></p>
      </div>
    </a>
    <a class="right-next"
       href="tipe_data.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><strong>Tipe Data</strong></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#apa-itu-naive-bayes"><strong>Apa itu Naive Bayes?</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#contoh-contoh-algoritme-naive-bayes"><strong>Contoh-Contoh algoritme Naive Bayes</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#jenis-jenis-naive-bayes"><strong>Jenis-Jenis Naive Bayes</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prinsip-teorema-bayes"><strong>Prinsip Teorema Bayes</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#langkah-langkah-klasifikasi"><strong>Langkah-Langkah Klasifikasi</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#contoh-kasus-dalam-data-numerik"><strong>Contoh Kasus dalam Data Numerik</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#langkah-langkah"><strong>Langkah-Langkah</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hitung-probabilitas-awal-p-y"><strong>1. Hitung Probabilitas Awal <span class="math notranslate nohighlight">\((P(Y))\)</span></strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hitung-likelihood-p-x-y"><strong>2. Hitung Likelihood <span class="math notranslate nohighlight">\(P(X|Y)\)</span></strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#gabungkan-dengan-teorema-bayes"><strong>3. Gabungkan dengan Teorema Bayes</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prediksi-kelas"><strong>4. Prediksi Kelas</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementasi-pada-data-iris"><strong>Implementasi pada Data Iris</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#memisahkan-outlier-dari-data"><strong>Memisahkan Outlier dari Data</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#menghitung-akurasi-dari-data"><strong>Menghitung Akurasi dari Data</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#implementasi-naive-bayes"><strong>Implementasi Naive Bayes</strong></a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dwi Prasetya Mumtaz
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>